## 什么是JVM
JVM全称Java Virtual Machine（Java虚拟机），通过模拟一个计算机来达到一个计算机所具有的功能。JVM屏蔽了了具体操作系统平台相关的信息，使得同一份Java的字节码文件，能够运行在不同平台上的JVM上。此外，JVM不仅可以运行Java语言编写的程序，也可运行其他语言，只要该语言编译生成的文件符合JVM的的规范，如Groovy、Kotlin、Scala等。

## JVM体系结构
当我们运行一个Java程序时，这个处于运行状态的Java程序就是一个JVM上的实例

JVM的结构主要有4部分组成：

* 类加载器

  在JVM启动时或者在类运行时将需要的class加载到JVM中。每个被JVM装在的类型都有一个对应的java.lang.Class类的实例来表示该类型，该实例可以唯一表示被JVM装载的class类，这些类的实例放在Java的堆中。

* 执行引擎

  负责执行class文件中包含的字节码指令，相当于实体机上的CPU。执行引擎是JVM的核心部分，执行引擎的作用就是解析JVM字节码指令，得到执行结果。在《Java虚拟机规范》中详细定义了执行引擎遇到每条字节码指令时应该处理什么，并且应该得到什么结果，但是并没有规定执行引擎应该如何或采取什么方式处理而得到这个结果。因为执行引擎具体采用什么方式由JVM的实现厂家自己去实现，可以是解释执行，也可以是JIT转成本地代码去执行，还是采用寄存器去执行都可以。这篇博客有对解释执行和编译执行的说明：[解释执行和编译执行](https://www.itzhai.com/jvm/java-code-compilation-mode-and-jvm-3-execution-modes.html)。

  执行引擎也就是执行一条条代码的一个流程，而代码都是包含在方法体内的，所以执行引擎本质上就是执行一个个方法所串起来的流程，对应到操作系统中一个执行流程是一个Java的线程。因为一个Java进程可以有多个同时执行的执行流程，即每个线程都有一个执行引擎在工作，有的执行引擎在执行用户的程序，而有的在执行JVM内部的程序，如Java垃圾收集器。

* 内存区，将内存化分成若干个区以模拟实际机器上的存储、记录和调度功能模块。

  一个JVM实例会有方法区、Java堆、Java栈、PC寄存器和本地方法区。其中方法区和Java堆是所有线程共享的，也就是可以被所有的执行引擎实例访问

* 本地方法调用，调用C或者C++实现的本地方法的代码返回结果。



![JVM体系结构图](https://raw.githubusercontent.com/hdsam/MyImages/master/MyNotes/20200918160815.jpg)

## JVM如何执行代码

java -XX:+PrintFlagsInitial > init.txt 可以打印虚拟机默认的配置参数



